% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\usepackage{amsmath,amssymb}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math} % this also loads fontspec
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
\usepackage{lmodern}
\ifPDFTeX\else
  % xetex/luatex font selection
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\usepackage{bookmark}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same}
\hypersetup{
  pdftitle={test},
  pdfauthor={Maxime Gamondele},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}

\title{test}
\author{Maxime Gamondele}
\date{2025-01-06}

\begin{document}
\maketitle

\subsection{R Markdown}\label{r-markdown}

This is an R Markdown document. Markdown is a simple formatting syntax
for authoring HTML, PDF, and MS Word documents. For more details on
using R Markdown see \url{http://rmarkdown.rstudio.com}.

When you click the \textbf{Knit} button a document will be generated
that includes both content as well as the output of any embedded R code
chunks within the document. You can embed an R code chunk like this:

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}
\CommentTok{\# Auteurs     : DIOP Mandir, GAMONDELE Maxime, SAMAKE Salif}
\CommentTok{\# Projet      : SAE 3.03 {-} Série Chronologique}
\CommentTok{\# Thématique  : Futures de Matières Premières}
\CommentTok{\# Source      : https://fr.investing.com}
\DocumentationTok{\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}

\CommentTok{\# Libraries}

\FunctionTok{library}\NormalTok{(dplyr)   }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Attaching package: 'dplyr'
\end{verbatim}

\begin{verbatim}
## The following objects are masked from 'package:stats':
## 
##     filter, lag
\end{verbatim}

\begin{verbatim}
## The following objects are masked from 'package:base':
## 
##     intersect, setdiff, setequal, union
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyr)      }
\FunctionTok{library}\NormalTok{(lubridate)  }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Attaching package: 'lubridate'
\end{verbatim}

\begin{verbatim}
## The following objects are masked from 'package:base':
## 
##     date, intersect, setdiff, union
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(ggplot2)   }
\FunctionTok{library}\NormalTok{(scales)   }
\FunctionTok{library}\NormalTok{(stats)    }
\FunctionTok{library}\NormalTok{(stringr)   }
\FunctionTok{library}\NormalTok{(dplyr)}
\FunctionTok{library}\NormalTok{(patchwork)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: package 'patchwork' was built under R version 4.3.3
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}
\CommentTok{\# {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}  Importation des données  {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-} \#}
\DocumentationTok{\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}

\CommentTok{\# lecture du jeu de donnée}
\NormalTok{data }\OtherTok{=} \FunctionTok{readRDS}\NormalTok{(}\StringTok{"fichier\_de\_travail.rds"}\NormalTok{) }

\CommentTok{\# vérification structure des données }
\FunctionTok{head}\NormalTok{(data)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 6 x 6
##   Date       Closed_Cotation Opened_Cotation Highest_Cotation Lowest_Cotation
##   <date>               <dbl>           <dbl>            <dbl>           <dbl>
## 1 2024-10-10           7208.           7380.            7436.           7190.
## 2 2024-10-09           7386            7144.            7442.           7114.
## 3 2024-10-08           7096            6986.            7230            6954.
## 4 2024-10-07           6983            6986             7061            6864 
## 5 2024-10-04           7055            7072.            7126            6851 
## 6 2024-10-03           7176            7038.            7188.           6889 
## # i 1 more variable: Futures <fct>
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{tail}\NormalTok{(data)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 6 x 6
##   Date       Closed_Cotation Opened_Cotation Highest_Cotation Lowest_Cotation
##   <date>               <dbl>           <dbl>            <dbl>           <dbl>
## 1 2010-01-08            726.            724.             740.            721.
## 2 2010-01-07            732.            736.             748             728 
## 3 2010-01-06            731.            724.             737.            716.
## 4 2010-01-05            723             726.             735.            722.
## 5 2010-01-04            722.            706.             726.            706.
## 6 2010-01-01            710.            710.             710.            710.
## # i 1 more variable: Futures <fct>
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{levels}\NormalTok{(data}\SpecialCharTok{$}\NormalTok{Futures)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "Cotation du cacao"         "Cotation du café"         
## [3] "Cotation du jus d'orange"  "Cotation du pétrole Brent"
## [5] "Cotation du sucre"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{str}\NormalTok{(data)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## tibble [18,851 x 6] (S3: tbl_df/tbl/data.frame)
##  $ Date            : Date[1:18851], format: "2024-10-10" "2024-10-09" ...
##  $ Closed_Cotation : num [1:18851] 7208 7386 7096 6983 7055 ...
##  $ Opened_Cotation : num [1:18851] 7380 7144 6986 6986 7072 ...
##  $ Highest_Cotation: num [1:18851] 7436 7442 7230 7061 7126 ...
##  $ Lowest_Cotation : num [1:18851] 7190 7114 6954 6864 6851 ...
##  $ Futures         : Factor w/ 5 levels "Cotation du cacao",..: 1 1 1 1 1 1 1 1 1 1 ...
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}
\CommentTok{\# {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}  Analyse de données       {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-} \#}
\DocumentationTok{\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}


\CommentTok{\# fonctions poour les graphique }
\CommentTok{\# {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}  chronique\_reg()          {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-} \#}
\CommentTok{\# Renvoie un chronogramme avec son lissage}

\NormalTok{chronique\_reg }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(data, titre, y\_col, span\_, lab\_x, lab\_y,sub\_,cap\_) \{}
  \FunctionTok{ggplot}\NormalTok{(data, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Month, }\AttributeTok{y =} \SpecialCharTok{!!}\FunctionTok{sym}\NormalTok{(y\_col))) }\SpecialCharTok{+} 
    \FunctionTok{geom\_line}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{color =} \StringTok{"Série brute"}\NormalTok{), }\AttributeTok{show.legend =} \ConstantTok{FALSE}\NormalTok{) }\SpecialCharTok{+}  \CommentTok{\# Exclure "Série brute" de la légende}
    \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{span =}\NormalTok{ span\_, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{color =} \StringTok{"Lissage"}\NormalTok{), }\AttributeTok{size =} \FloatTok{0.5}\NormalTok{, }\AttributeTok{se =} \ConstantTok{FALSE}\NormalTok{) }\SpecialCharTok{+}  \CommentTok{\# Lissage en rouge}
    \FunctionTok{labs}\NormalTok{(}
      \AttributeTok{title =}\NormalTok{ titre,}
      \AttributeTok{x =}\NormalTok{ lab\_x,}
      \AttributeTok{y =}\NormalTok{ lab\_y,}
      \AttributeTok{subtitle =}\NormalTok{ sub\_,}
      \AttributeTok{caption =} \FunctionTok{c}\NormalTok{(cap\_),}
      \AttributeTok{color =} \StringTok{""}
\NormalTok{    ) }\SpecialCharTok{+} 
    \FunctionTok{scale\_color\_manual}\NormalTok{(}\AttributeTok{values =} \FunctionTok{c}\NormalTok{(}\StringTok{"Lissage"} \OtherTok{=} \StringTok{"red"}\NormalTok{)) }\SpecialCharTok{+} 
    \FunctionTok{theme\_bw}\NormalTok{() }\SpecialCharTok{+} 
    \FunctionTok{theme}\NormalTok{(}
      \AttributeTok{plot.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{hjust =} \FloatTok{0.5}\NormalTok{, }\AttributeTok{face =} \StringTok{"bold"}\NormalTok{, }\AttributeTok{size =} \DecValTok{15}\NormalTok{),}
      \AttributeTok{plot.subtitle =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{hjust =} \FloatTok{0.5}\NormalTok{, }\AttributeTok{colour =} \StringTok{"blue4"}\NormalTok{),}
      \AttributeTok{plot.caption =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{hjust =} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{), }\AttributeTok{face =} \StringTok{"bold"}\NormalTok{, }\AttributeTok{colour =} \StringTok{"blue4"}\NormalTok{),}
      \AttributeTok{legend.position =} \StringTok{"bottom"}
\NormalTok{    )}
\NormalTok{\}}

\CommentTok{\# {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-} \#}
\CommentTok{\#.      1. Boxplots des closed cotation annuels pour chaque matière première   \# }
\CommentTok{\# {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-} \#}

\CommentTok{\# Affichage des différents raw materials}
\FunctionTok{levels}\NormalTok{(data}\SpecialCharTok{$}\NormalTok{Futures)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "Cotation du cacao"         "Cotation du café"         
## [3] "Cotation du jus d'orange"  "Cotation du pétrole Brent"
## [5] "Cotation du sucre"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{data}\SpecialCharTok{$}\NormalTok{Year }\OtherTok{\textless{}{-}} \FunctionTok{year}\NormalTok{(data}\SpecialCharTok{$}\NormalTok{Date)}
\NormalTok{data}\SpecialCharTok{$}\NormalTok{Month }\OtherTok{\textless{}{-}} \FunctionTok{floor\_date}\NormalTok{(data}\SpecialCharTok{$}\NormalTok{Date, }\StringTok{"month"}\NormalTok{)}
\FunctionTok{head}\NormalTok{(data)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 6 x 8
##   Date       Closed_Cotation Opened_Cotation Highest_Cotation Lowest_Cotation
##   <date>               <dbl>           <dbl>            <dbl>           <dbl>
## 1 2024-10-10           7208.           7380.            7436.           7190.
## 2 2024-10-09           7386            7144.            7442.           7114.
## 3 2024-10-08           7096            6986.            7230            6954.
## 4 2024-10-07           6983            6986             7061            6864 
## 5 2024-10-04           7055            7072.            7126            6851 
## 6 2024-10-03           7176            7038.            7188.           6889 
## # i 3 more variables: Futures <fct>, Year <dbl>, Month <date>
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Graphique}

\FunctionTok{ggplot}\NormalTok{(data, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =} \FunctionTok{factor}\NormalTok{(Year), }\AttributeTok{y =}\NormalTok{ Closed\_Cotation, }\AttributeTok{fill =}\NormalTok{ Futures)) }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{(}\AttributeTok{outlier.size =} \DecValTok{1}\NormalTok{, }\AttributeTok{outlier.color =} \StringTok{"black"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{facet\_wrap}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{Futures, }\AttributeTok{scales =} \StringTok{"free\_y"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}
    \AttributeTok{title =} \StringTok{"Boxplots annuels des cotations journalières de clôture"}\NormalTok{,}
    \AttributeTok{x =} \StringTok{"Année"}\NormalTok{, }
    \AttributeTok{y =} \StringTok{"Cotation de clôture (en $)"}\NormalTok{,}
    \AttributeTok{fill =} \StringTok{"Matière première"}\NormalTok{,}
    \AttributeTok{subtitle =} \StringTok{"Source : investing.com"}\NormalTok{,}
    \AttributeTok{caption =} \FunctionTok{c}\NormalTok{(}\StringTok{"BUT Science des Données {-} Lisieux"}\NormalTok{,}\StringTok{"Diop Mandir {-} Gamondele Maxime {-} Samake Salif"}\NormalTok{)}
\NormalTok{  ) }\SpecialCharTok{+}
  \FunctionTok{theme\_bw}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}
    \AttributeTok{axis.text.x =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{hjust =} \DecValTok{1}\NormalTok{, }\AttributeTok{angle =} \DecValTok{45}\NormalTok{),}
    \AttributeTok{strip.text =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{face =} \StringTok{"bold"}\NormalTok{), }
    \AttributeTok{legend.position =} \FunctionTok{c}\NormalTok{(}\FloatTok{0.85}\NormalTok{, }\FloatTok{0.2}\NormalTok{),  }
    \AttributeTok{legend.text =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{15}\NormalTok{),}
    \AttributeTok{legend.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{24}\NormalTok{, }\AttributeTok{face =} \StringTok{"bold"}\NormalTok{),}
    \AttributeTok{plot.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{hjust =} \FloatTok{0.5}\NormalTok{, }\AttributeTok{face =} \StringTok{"bold"}\NormalTok{, }\AttributeTok{size =} \DecValTok{15}\NormalTok{),}
    \AttributeTok{plot.subtitle =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{hjust =} \FloatTok{0.5}\NormalTok{, }\AttributeTok{colour =} \StringTok{"blue4"}\NormalTok{),}
    \AttributeTok{plot.caption =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{hjust =} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{), }\AttributeTok{face =} \StringTok{"bold"}\NormalTok{, }\AttributeTok{colour =} \StringTok{"blue4"}\NormalTok{)}
\NormalTok{  )}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: Vectorized input to `element_text()` is not officially supported.
## i Results may be unexpected or may change in future versions of ggplot2.
\end{verbatim}

\begin{verbatim}
## Warning: A numeric `legend.position` argument in `theme()` was deprecated in ggplot2
## 3.5.0.
## i Please use the `legend.position.inside` argument of `theme()` instead.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
## generated.
\end{verbatim}

\includegraphics{test_files/figure-latex/cars-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-} \#}
\CommentTok{\#     2. Évolution mensuelle avec une courbe de régression lissée              \# }
\CommentTok{\# {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-} \#}

\CommentTok{\# Préparation des données pour le graph}
\CommentTok{\# Calcul de la moyenne mensuelle pour chaque matière première}
\NormalTok{data\_mois }\OtherTok{\textless{}{-}}\NormalTok{ data }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{YearMonth =} \FunctionTok{floor\_date}\NormalTok{(Date, }\StringTok{"month"}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{group\_by}\NormalTok{(YearMonth, Futures) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{Moyenne\_Cotation =} \FunctionTok{mean}\NormalTok{(Closed\_Cotation, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{), }\AttributeTok{.groups =} \StringTok{"drop"}\NormalTok{)}

\CommentTok{\# Graphique}
\FunctionTok{ggplot}\NormalTok{(data\_mois, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ YearMonth, }\AttributeTok{y =}\NormalTok{ Moyenne\_Cotation, )) }\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{color =}\NormalTok{ Futures), }\AttributeTok{size =} \FloatTok{1.2}\NormalTok{) }\SpecialCharTok{+}  
  \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{method =} \StringTok{"gam"}\NormalTok{, }\AttributeTok{se =} \ConstantTok{FALSE}\NormalTok{, }\AttributeTok{color =} \StringTok{"black"}\NormalTok{, }\AttributeTok{size =} \DecValTok{1}\NormalTok{) }\SpecialCharTok{+}  \CommentTok{\# ou bien loess avec un span à 0.25}
  \FunctionTok{facet\_wrap}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{Futures, }\AttributeTok{scales =} \StringTok{"free\_y"}\NormalTok{) }\SpecialCharTok{+}  
  \FunctionTok{theme\_bw}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}
    \AttributeTok{title =} \StringTok{"Évolution moyenne mensuelle de la cotation journalière de chaque matière première"}\NormalTok{,}
    \AttributeTok{x =} \StringTok{"Année"}\NormalTok{,}
    \AttributeTok{y =} \StringTok{"Cotation (en $)"}\NormalTok{,}
    \AttributeTok{color =} \StringTok{"Matières premières"}\NormalTok{,}
    \AttributeTok{subtitle =} \StringTok{"Source : investing.com"}\NormalTok{,}
    \AttributeTok{caption =} \FunctionTok{c}\NormalTok{(}\StringTok{"BUT Science des Données {-} Lisieux"}\NormalTok{,}\StringTok{"Diop Mandir {-} Gamondele Maxime {-} Samake Salif"}\NormalTok{)}
\NormalTok{  ) }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}
    \AttributeTok{axis.text.x =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{hjust =} \DecValTok{1}\NormalTok{, }\AttributeTok{angle =} \DecValTok{45}\NormalTok{),}
    \AttributeTok{strip.text =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{face =} \StringTok{"bold"}\NormalTok{), }
    \AttributeTok{legend.position =} \FunctionTok{c}\NormalTok{(}\FloatTok{0.85}\NormalTok{, }\FloatTok{0.2}\NormalTok{),  }
    \AttributeTok{legend.text =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{15}\NormalTok{),}
    \AttributeTok{legend.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{24}\NormalTok{, }\AttributeTok{face =} \StringTok{"bold"}\NormalTok{),}
    \AttributeTok{plot.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{hjust =} \FloatTok{0.5}\NormalTok{, }\AttributeTok{face =} \StringTok{"bold"}\NormalTok{, }\AttributeTok{size =} \DecValTok{15}\NormalTok{),}
    \AttributeTok{plot.subtitle =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{hjust =} \FloatTok{0.5}\NormalTok{, }\AttributeTok{colour =} \StringTok{"blue4"}\NormalTok{),}
    \AttributeTok{plot.caption =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{hjust =} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{), }\AttributeTok{face =} \StringTok{"bold"}\NormalTok{, }\AttributeTok{colour =} \StringTok{"blue4"}\NormalTok{)}
\NormalTok{  )}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
## i Please use `linewidth` instead.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
## generated.
\end{verbatim}

\begin{verbatim}
## Warning: Vectorized input to `element_text()` is not officially supported.
## i Results may be unexpected or may change in future versions of ggplot2.
\end{verbatim}

\begin{verbatim}
## `geom_smooth()` using formula = 'y ~ s(x, bs = "cs")'
\end{verbatim}

\includegraphics{test_files/figure-latex/cars-2.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-} \#}
\CommentTok{\#.   3. Taux d\textquotesingle{}évolution de la moyenne mensuelle des cotations journalières    \# }
\CommentTok{\# {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-} \#}

\CommentTok{\# Préparation des donnée pour le graphique}
\CommentTok{\# Groupement et calcul de la moyenne mensuelle}
\NormalTok{data }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(Futures, }\AttributeTok{Annee\_mois =} \FunctionTok{format}\NormalTok{(Date, }\StringTok{"\%Y{-}\%m"}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarize}\NormalTok{(}\AttributeTok{moyenne\_mensuelle =} \FunctionTok{mean}\NormalTok{(Closed\_Cotation, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)) }\OtherTok{{-}\textgreater{}}\NormalTok{ data1}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `summarise()` has grouped output by 'Futures'. You can override using the
## `.groups` argument.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{data1 }\OtherTok{\textless{}{-}}\NormalTok{ data1 }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(Futures) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{Taux\_variation\_mensuel =}\NormalTok{ (moyenne\_mensuelle }\SpecialCharTok{{-}} \FunctionTok{lag}\NormalTok{(moyenne\_mensuelle)) }\SpecialCharTok{/} \FunctionTok{lag}\NormalTok{(moyenne\_mensuelle) }\SpecialCharTok{*} \DecValTok{100}\NormalTok{)}
\NormalTok{data1 }\OtherTok{\textless{}{-}}\NormalTok{ data1 }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(Futures) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{Taux\_variation\_mensuel =} \FunctionTok{c}\NormalTok{(}\ConstantTok{NA}\NormalTok{, }\FunctionTok{diff}\NormalTok{(moyenne\_mensuelle) }\SpecialCharTok{/}\NormalTok{ moyenne\_mensuelle[}\SpecialCharTok{{-}}\FunctionTok{length}\NormalTok{(moyenne\_mensuelle)] }\SpecialCharTok{*} \DecValTok{100}\NormalTok{))}
\NormalTok{data1}\SpecialCharTok{$}\NormalTok{Annee\_mois }\OtherTok{\textless{}{-}} \FunctionTok{as.Date}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(data1}\SpecialCharTok{$}\NormalTok{Annee\_mois, }\StringTok{"{-}01"}\NormalTok{))}

\CommentTok{\# Conversion de Annee\_mois en date}
\NormalTok{data1}\SpecialCharTok{$}\NormalTok{Annee\_mois }\OtherTok{\textless{}{-}} \FunctionTok{as.Date}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(data1}\SpecialCharTok{$}\NormalTok{Annee\_mois, }\StringTok{"{-}01"}\NormalTok{))}

\CommentTok{\# graphique}
\FunctionTok{ggplot}\NormalTok{(data1, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Annee\_mois, }\AttributeTok{y =}\NormalTok{ Taux\_variation\_mensuel, }\AttributeTok{group =}\NormalTok{ Futures, }\AttributeTok{color =}\NormalTok{ Futures)) }\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{method =} \StringTok{\textquotesingle{}loess\textquotesingle{}}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{facet\_wrap}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{ Futures, }\AttributeTok{scales =} \StringTok{"free\_y"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}
    \AttributeTok{title =} \StringTok{"Taux d\textquotesingle{}évolution de la moyenne mensuelle des cotations journalières"}\NormalTok{,}
    \AttributeTok{x =} \StringTok{"Date"}\NormalTok{,}
    \AttributeTok{y =} \StringTok{"Taux d\textquotesingle{}évolution (\%)"}\NormalTok{,}
    \AttributeTok{color =} \StringTok{"Matière première"}\NormalTok{,}
    \AttributeTok{subtitle =} \StringTok{"Source : investing.com"}\NormalTok{,}
    \AttributeTok{caption =} \FunctionTok{c}\NormalTok{(}\StringTok{"BUT Science des Données {-} Lisieux"}\NormalTok{,}\StringTok{"Diop Mandir {-} Gamondele Maxime {-} Samake Salif"}\NormalTok{)}
\NormalTok{  ) }\SpecialCharTok{+}
  \FunctionTok{theme\_bw}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}
    \AttributeTok{axis.text.x =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{hjust =} \DecValTok{1}\NormalTok{, }\AttributeTok{angle =} \DecValTok{45}\NormalTok{),}
    \AttributeTok{strip.text =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{face =} \StringTok{"bold"}\NormalTok{), }
    \AttributeTok{legend.position =} \FunctionTok{c}\NormalTok{(}\FloatTok{0.85}\NormalTok{, }\FloatTok{0.2}\NormalTok{),  }
    \AttributeTok{legend.text =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{15}\NormalTok{),}
    \AttributeTok{legend.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{24}\NormalTok{, }\AttributeTok{face =} \StringTok{"bold"}\NormalTok{),}
    \AttributeTok{plot.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{hjust =} \FloatTok{0.5}\NormalTok{, }\AttributeTok{face =} \StringTok{"bold"}\NormalTok{, }\AttributeTok{size =} \DecValTok{15}\NormalTok{),}
    \AttributeTok{plot.subtitle =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{hjust =} \FloatTok{0.5}\NormalTok{, }\AttributeTok{colour =} \StringTok{"blue4"}\NormalTok{),}
    \AttributeTok{plot.caption =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{hjust =} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{), }\AttributeTok{face =} \StringTok{"bold"}\NormalTok{, }\AttributeTok{colour =} \StringTok{"blue4"}\NormalTok{)}
\NormalTok{  )}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: Vectorized input to `element_text()` is not officially supported.
## i Results may be unexpected or may change in future versions of ggplot2.
\end{verbatim}

\begin{verbatim}
## `geom_smooth()` using formula = 'y ~ x'
\end{verbatim}

\begin{verbatim}
## Warning: Removed 5 rows containing non-finite outside the scale range
## (`stat_smooth()`).
\end{verbatim}

\begin{verbatim}
## Warning: Removed 5 rows containing missing values or values outside the scale range
## (`geom_line()`).
\end{verbatim}

\includegraphics{test_files/figure-latex/cars-3.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-} \#}
\CommentTok{\#.      4.Relation entre les valeurs moyennes mensuelles du café et du cacao  \# }
\CommentTok{\# {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-} \#}

\CommentTok{\# Étape 1 : Calcul des moyennes mensuelles pour le café}
\NormalTok{data\_cafe }\OtherTok{\textless{}{-}}\NormalTok{ data }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(Futures }\SpecialCharTok{==} \StringTok{"Cotation du café"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{Annee\_mois =} \FunctionTok{format}\NormalTok{(Date, }\StringTok{"\%Y{-}\%m"}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(Annee\_mois) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarize}\NormalTok{(}\AttributeTok{Moyenne\_Cafe =} \FunctionTok{mean}\NormalTok{(Closed\_Cotation, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ungroup}\NormalTok{()}

\CommentTok{\# Étape 2 : Calcul des moyennes mensuelles pour le cacao}
\NormalTok{data\_cacao }\OtherTok{\textless{}{-}}\NormalTok{ data }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(Futures }\SpecialCharTok{==} \StringTok{"Cotation du cacao"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{Annee\_mois =} \FunctionTok{format}\NormalTok{(Date, }\StringTok{"\%Y{-}\%m"}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(Annee\_mois) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarize}\NormalTok{(}\AttributeTok{Moyenne\_Cacao =} \FunctionTok{mean}\NormalTok{(Closed\_Cotation, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ungroup}\NormalTok{()}

\CommentTok{\# Étape 3 : Fusionner les deux jeux de données sur "Annee\_mois"}
\NormalTok{jointure\_mooyenne }\OtherTok{=} \FunctionTok{merge}\NormalTok{(data\_cafe, data\_cacao, }\AttributeTok{by =} \StringTok{"Annee\_mois"}\NormalTok{, }\AttributeTok{all =} \ConstantTok{TRUE}\NormalTok{)}

\CommentTok{\# Modèle de régression linéaire}
\NormalTok{model }\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(Moyenne\_Cacao }\SpecialCharTok{\textasciitilde{}}\NormalTok{ Moyenne\_Cafe, }\AttributeTok{data =}\NormalTok{ jointure\_mooyenne)}
\FunctionTok{summary}\NormalTok{(model)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = Moyenne_Cacao ~ Moyenne_Cafe, data = jointure_mooyenne)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1502.3  -614.7  -127.3   190.0  6581.4 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(>|t|)    
## (Intercept)  1186.538    317.085   3.742 0.000247 ***
## Moyenne_Cafe   10.830      1.902   5.695 5.09e-08 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 1170 on 176 degrees of freedom
## Multiple R-squared:  0.1556, Adjusted R-squared:  0.1508 
## F-statistic: 32.43 on 1 and 176 DF,  p-value: 5.093e-08
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cor}\NormalTok{(jointure\_mooyenne}\SpecialCharTok{$}\NormalTok{Moyenne\_Cacao, jointure\_mooyenne}\SpecialCharTok{$}\NormalTok{Moyenne\_Cafe, }\AttributeTok{method =} \StringTok{"pearson"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.3944481
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Nuage de points avec lissage et régression linéaire}
\FunctionTok{ggplot}\NormalTok{(jointure\_mooyenne, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Moyenne\_Cafe, }\AttributeTok{y =}\NormalTok{ Moyenne\_Cacao)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{color =} \StringTok{"blue"}\NormalTok{, }
             \AttributeTok{size =} \DecValTok{2}\NormalTok{, }
             \AttributeTok{alpha =} \FloatTok{0.7}\NormalTok{, }
             \AttributeTok{shape =} \DecValTok{21}\NormalTok{, }
             \AttributeTok{fill =} \StringTok{"blue"}\NormalTok{) }\SpecialCharTok{+} 
  \FunctionTok{geom\_smooth}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{color =} \StringTok{"Régression linéaire"}\NormalTok{), }
              \AttributeTok{method =} \StringTok{"lm"}\NormalTok{, }
              \AttributeTok{se =} \ConstantTok{FALSE}\NormalTok{, }
              \AttributeTok{size =} \DecValTok{1}\NormalTok{) }\SpecialCharTok{+}  
  \FunctionTok{geom\_smooth}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{color =} \StringTok{"Lissage"}\NormalTok{), }
              \AttributeTok{method =} \StringTok{"loess"}\NormalTok{, }
              \AttributeTok{se =} \ConstantTok{TRUE}\NormalTok{, }
              \AttributeTok{size =} \FloatTok{0.8}\NormalTok{) }\SpecialCharTok{+}  
  \FunctionTok{labs}\NormalTok{(}
    \AttributeTok{title =} \StringTok{"Relation entre les valeurs moyennes mensuelles du café et du cacao"}\NormalTok{,}
    \AttributeTok{x =} \StringTok{"Moyenne mensuelle {-} Café"}\NormalTok{,}
    \AttributeTok{y =} \StringTok{"Moyenne mensuelle {-} Cacao"}\NormalTok{,}
    \AttributeTok{subtitle =} \StringTok{"Source : investing.com"}\NormalTok{,}
    \AttributeTok{caption =} \FunctionTok{c}\NormalTok{(}\StringTok{"BUT Science des Données {-} Lisieux"}\NormalTok{, }\StringTok{"Diop Mandir {-} Gamondele Maxime {-} Samake Salif"}\NormalTok{),}
    \AttributeTok{color =} \StringTok{""}
\NormalTok{  ) }\SpecialCharTok{+}
  \FunctionTok{scale\_color\_manual}\NormalTok{(}\AttributeTok{values =} \FunctionTok{c}\NormalTok{(}\StringTok{"Régression linéaire"} \OtherTok{=} \StringTok{"green4"}\NormalTok{, }\StringTok{"Lissage"} \OtherTok{=} \StringTok{"red"}\NormalTok{)) }\SpecialCharTok{+} 
  \FunctionTok{theme\_bw}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}
    \AttributeTok{legend.position =} \StringTok{"bottom"}\NormalTok{,  }
    \AttributeTok{legend.justification =} \StringTok{"center"}\NormalTok{, }
    \AttributeTok{plot.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{hjust =} \FloatTok{0.5}\NormalTok{, }\AttributeTok{face =} \StringTok{"bold"}\NormalTok{, }\AttributeTok{size =} \DecValTok{15}\NormalTok{),}
    \AttributeTok{plot.subtitle =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{hjust =} \FloatTok{0.5}\NormalTok{, }\AttributeTok{colour =} \StringTok{"blue4"}\NormalTok{),}
    \AttributeTok{plot.caption =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{hjust =} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{), }\AttributeTok{face =} \StringTok{"bold"}\NormalTok{, }\AttributeTok{colour =} \StringTok{"blue4"}\NormalTok{),}
    \AttributeTok{legend.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{face =} \StringTok{"bold"}\NormalTok{),  }
    \AttributeTok{legend.text =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{10}\NormalTok{)  }
\NormalTok{  ) }\SpecialCharTok{+}
  \FunctionTok{annotate}\NormalTok{(}
    \StringTok{"text"}\NormalTok{, }
    \AttributeTok{x =} \DecValTok{125}\NormalTok{, }
    \AttributeTok{y =} \DecValTok{8000}\NormalTok{, }
    \AttributeTok{label =} \StringTok{" m(x) = 1186,5 + 10,8x}\SpecialCharTok{\textbackslash{}n}\StringTok{R² = 15,56 \%}\SpecialCharTok{\textbackslash{}n}\StringTok{p{-}val = 0"}\NormalTok{, }
    \AttributeTok{fontface =} \StringTok{"bold"}\NormalTok{,}
    \AttributeTok{color =} \StringTok{"green4"}\NormalTok{, }
    \AttributeTok{size =} \FloatTok{3.5}
\NormalTok{  )}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: Vectorized input to `element_text()` is not officially supported.
## i Results may be unexpected or may change in future versions of ggplot2.
\end{verbatim}

\begin{verbatim}
## `geom_smooth()` using formula = 'y ~ x'
\end{verbatim}

\begin{verbatim}
## `geom_smooth()` using formula = 'y ~ x'
\end{verbatim}

\includegraphics{test_files/figure-latex/cars-4.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Affichage de la P{-}value}
\FunctionTok{cat}\NormalTok{(}\FunctionTok{sprintf}\NormalTok{(}\StringTok{"P{-}value : \%.5f}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{, }\FunctionTok{summary}\NormalTok{(model)}\SpecialCharTok{$}\NormalTok{coefficients[}\DecValTok{2}\NormalTok{, }\DecValTok{4}\NormalTok{]))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## P-value : 0.00000
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-} \#}
\CommentTok{\#          5.1 Etude du brent de 2010 à fin 2024 avec lissage                  \#}
\CommentTok{\# {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-} \#}

\CommentTok{\# Préparation des donnée pour le graphique }

\NormalTok{data\_brent }\OtherTok{=} \FunctionTok{filter}\NormalTok{(data,data}\SpecialCharTok{$}\NormalTok{Futures }\SpecialCharTok{==} \StringTok{"Cotation du pétrole Brent"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{select}\NormalTok{(Date,Closed\_Cotation) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{Month =} \FunctionTok{floor\_date}\NormalTok{(Date, }\StringTok{"month"}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}  
  \FunctionTok{group\_by}\NormalTok{(Month) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{Monthly\_Avg\_Closed\_Cotation =} \FunctionTok{mean}\NormalTok{(Closed\_Cotation, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{))}


\CommentTok{\# Base du graphique}
\NormalTok{graph1 }\OtherTok{=} \FunctionTok{chronique\_reg}\NormalTok{(data\_brent,}
              \StringTok{"Évolution de la cotation de clôture mensuelle moyenne du pétrole Brent"}\NormalTok{,}
              \StringTok{"Monthly\_Avg\_Closed\_Cotation"}\NormalTok{,}
              \FloatTok{0.2}\NormalTok{,}
              \StringTok{"Janvier 2010 {-} Octobre 2024"}\NormalTok{,}
              \StringTok{"Cotation (en $)"}\NormalTok{,}
              \StringTok{"Source : investing.com"}\NormalTok{,}
              \FunctionTok{c}\NormalTok{(}\StringTok{"BUT Science des Données {-} Lisieux"}\NormalTok{,}\StringTok{"Diop Mandir {-} Gamondele Maxime {-} Samake Salif"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: Vectorized input to `element_text()` is not officially supported.
## i Results may be unexpected or may change in future versions of ggplot2.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Ajout d\textquotesingle{}éléments de précision au graphique}
\CommentTok{\# graphique de base + les dates clès}
\NormalTok{graph1 }\OtherTok{\textless{}{-}}\NormalTok{ graph1 }\SpecialCharTok{+} 
  \FunctionTok{geom\_vline}\NormalTok{(}\AttributeTok{xintercept =} \FunctionTok{as.Date}\NormalTok{(}\StringTok{"2016{-}01{-}01"}\NormalTok{),}
             \AttributeTok{color =} \StringTok{"purple"}\NormalTok{,}
             \AttributeTok{linetype =} \StringTok{"dashed"}\NormalTok{) }\SpecialCharTok{+} 
  \FunctionTok{annotate}\NormalTok{(}\StringTok{"text"}\NormalTok{,}
           \AttributeTok{x =} \FunctionTok{as.Date}\NormalTok{(}\StringTok{"2016{-}01{-}01"}\NormalTok{)}\SpecialCharTok{+}\DecValTok{80}\NormalTok{,}
           \AttributeTok{y =} \DecValTok{30}\NormalTok{, }
           \AttributeTok{label =} \StringTok{"Abondance de l\textquotesingle{}offre}\SpecialCharTok{\textbackslash{}n}\StringTok{janvier 2016"}\NormalTok{, }
           \AttributeTok{color =} \StringTok{"purple"}\NormalTok{, }
           \AttributeTok{hjust =} \DecValTok{0}\NormalTok{)}\SpecialCharTok{+} 
  \FunctionTok{geom\_vline}\NormalTok{(}\AttributeTok{xintercept =} \FunctionTok{as.Date}\NormalTok{(}\StringTok{"2020{-}04{-}01"}\NormalTok{),}
             \AttributeTok{color =} \StringTok{"blue"}\NormalTok{, }
             \AttributeTok{linetype =} \StringTok{"dashed"}\NormalTok{) }\SpecialCharTok{+} 
  \FunctionTok{annotate}\NormalTok{(}\StringTok{"text"}\NormalTok{, }
           \AttributeTok{x =} \FunctionTok{as.Date}\NormalTok{(}\StringTok{"2020{-}04{-}01"}\NormalTok{) }\SpecialCharTok{+}\DecValTok{80}\NormalTok{, }
           \AttributeTok{y =} \DecValTok{30}\NormalTok{, }\AttributeTok{label =} \StringTok{"Crise du Covid{-}19}\SpecialCharTok{\textbackslash{}n}\StringTok{avril 2020"}\NormalTok{, }
           \AttributeTok{color =} \StringTok{"blue"}\NormalTok{, }
           \AttributeTok{hjust =} \DecValTok{0}\NormalTok{)}
\FunctionTok{print}\NormalTok{(graph1)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `geom_smooth()` using method = 'loess' and formula = 'y ~ x'
\end{verbatim}

\includegraphics{test_files/figure-latex/cars-5.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-} \#}
\CommentTok{\#            5.2 Etude de la saisonnalité pour chaque année                    \#}
\CommentTok{\# {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-} \#}

\CommentTok{\# Calcul de la tendance globale à l\textquotesingle{}aide de yt, mt et st}
\NormalTok{trend\_brent }\OtherTok{=} \FunctionTok{loess}\NormalTok{(Monthly\_Avg\_Closed\_Cotation }\SpecialCharTok{\textasciitilde{}} \FunctionTok{as.numeric}\NormalTok{(Month),}
                    \AttributeTok{data =}\NormalTok{ data\_brent, }\AttributeTok{span =} \FloatTok{0.2}\NormalTok{)}

\CommentTok{\# Calcul de la saisonnalité st avec st = yt {-} mt}
\NormalTok{data\_brent }\OtherTok{=}\NormalTok{ data\_brent }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}
    \AttributeTok{trend =} \FunctionTok{predict}\NormalTok{(trend\_brent), }\CommentTok{\#mt}
\NormalTok{    saisonnalités }\OtherTok{=}\NormalTok{ Monthly\_Avg\_Closed\_Cotation }\SpecialCharTok{{-}}\NormalTok{ trend,  }\CommentTok{\#st = yt {-} mt}
    \AttributeTok{year =} \FunctionTok{year}\NormalTok{(Month), }
    \AttributeTok{month\_day =} \FunctionTok{format}\NormalTok{(Month, }\StringTok{"\%m{-}\%d"}\NormalTok{)}
\NormalTok{  )}

\CommentTok{\# Convertir month\_day en Date}
\NormalTok{data\_brent}\SpecialCharTok{$}\NormalTok{month\_day }\OtherTok{\textless{}{-}} \FunctionTok{as.Date}\NormalTok{(}\FunctionTok{paste}\NormalTok{(}\StringTok{"2010"}\NormalTok{, data\_brent}\SpecialCharTok{$}\NormalTok{month\_day, }\StringTok{"01"}\NormalTok{, }\AttributeTok{sep =} \StringTok{"{-}"}\NormalTok{))}
\FunctionTok{Sys.setlocale}\NormalTok{(}\StringTok{"LC\_TIME"}\NormalTok{, }\StringTok{"fr\_FR.UTF{-}8"}\NormalTok{) }\CommentTok{\# mon ordi anglophone donc transformation en fr}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "fr_FR.UTF-8"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# graphique en superposant les années pour visualiser si il y a une silmilitude}
\CommentTok{\# d\textquotesingle{}année en année}
\FunctionTok{ggplot}\NormalTok{(data\_brent, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ month\_day, }\AttributeTok{y =}\NormalTok{ saisonnalités, }\AttributeTok{color =} \FunctionTok{factor}\NormalTok{(year), }\AttributeTok{group =}\NormalTok{ year)) }\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}
    \AttributeTok{title =} \StringTok{"Composante saisonnière de la cotation du Pétrole Brent (2010{-}2024)"}\NormalTok{,}
    \AttributeTok{x =} \StringTok{"Mois"}\NormalTok{,}
    \AttributeTok{y =} \StringTok{"Variation (en $)"}\NormalTok{,}
    \AttributeTok{color =} \StringTok{"Année"}\NormalTok{,}
    \AttributeTok{subtitle =} \StringTok{"Source : investing.com"}\NormalTok{,}
    \AttributeTok{caption =} \FunctionTok{c}\NormalTok{(}\StringTok{"BUT Science des Données {-} Lisieux"}\NormalTok{,}\StringTok{"Diop Mandir {-} Gamondele Maxime {-} Samake Salif"}\NormalTok{)}
\NormalTok{  ) }\SpecialCharTok{+}
  \FunctionTok{scale\_x\_date}\NormalTok{(}\AttributeTok{labels =}\NormalTok{ scales}\SpecialCharTok{::}\FunctionTok{date\_format}\NormalTok{(}\StringTok{"\%B"}\NormalTok{), }\AttributeTok{breaks =} \StringTok{"1 month"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_bw}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}
    \AttributeTok{legend.position =} \StringTok{"bottom"}\NormalTok{,}
    \AttributeTok{legend.box =} \StringTok{"horizontal"}\NormalTok{,}
    \AttributeTok{legend.direction =} \StringTok{"horizontal"}\NormalTok{,}
    \AttributeTok{axis.text.x =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{angle =} \DecValTok{45}\NormalTok{, }\AttributeTok{hjust =} \DecValTok{1}\NormalTok{),}
    \AttributeTok{plot.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{hjust =} \FloatTok{0.5}\NormalTok{, }\AttributeTok{face =} \StringTok{"bold"}\NormalTok{, }\AttributeTok{size =} \DecValTok{15}\NormalTok{),}
    \AttributeTok{plot.subtitle =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{hjust =} \FloatTok{0.5}\NormalTok{, }\AttributeTok{colour =} \StringTok{"blue4"}\NormalTok{),}
    \AttributeTok{plot.caption =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{hjust =} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{), }\AttributeTok{face =} \StringTok{"bold"}\NormalTok{, }\AttributeTok{colour =} \StringTok{"blue4"}\NormalTok{)}
\NormalTok{  ) }\SpecialCharTok{+}
  \FunctionTok{guides}\NormalTok{(}\AttributeTok{color =} \FunctionTok{guide\_legend}\NormalTok{(}\AttributeTok{nrow =} \DecValTok{1}\NormalTok{, }\AttributeTok{byrow =} \ConstantTok{TRUE}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: Vectorized input to `element_text()` is not officially supported.
## i Results may be unexpected or may change in future versions of ggplot2.
\end{verbatim}

\includegraphics{test_files/figure-latex/cars-6.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-} \#}
\CommentTok{\#                  5.3 Etude du brent sur la période 2020{-}2024                 \#}
\CommentTok{\# {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-} \#}

\CommentTok{\# Filtrage des données pour n\textquotesingle{}avoir que cette période}
\NormalTok{data\_brent\_2020 }\OtherTok{=}\NormalTok{ data\_brent }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(Month }\SpecialCharTok{\textgreater{}=} \FunctionTok{as.Date}\NormalTok{(}\StringTok{"2020{-}01{-}01"}\NormalTok{))}

\CommentTok{\# base du graphique}
\NormalTok{lissage1 }\OtherTok{=} \FunctionTok{chronique\_reg}\NormalTok{(data\_brent\_2020,}
              \StringTok{"Cotation du pétrole Brent"}\NormalTok{,}
              \StringTok{"Monthly\_Avg\_Closed\_Cotation"}\NormalTok{,}
              \FloatTok{0.2}\NormalTok{,}
              \StringTok{"Janvier 2010 {-} Octobre 2024"}\NormalTok{,}
              \StringTok{"Cotation (en $)"}\NormalTok{,}
              \StringTok{"Source : investing.com"}\NormalTok{,}
              \FunctionTok{c}\NormalTok{(}\StringTok{"BUT Science des Données {-} Lisieux"}\NormalTok{,}\StringTok{"Diop Mandir {-} Gamondele Maxime {-} Samake Salif"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: Vectorized input to `element_text()` is not officially supported.
## i Results may be unexpected or may change in future versions of ggplot2.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# ajout d\textquotesingle{}élément de précision }
\NormalTok{lissage }\OtherTok{\textless{}{-}}\NormalTok{ lissage1 }\SpecialCharTok{+} 
  \FunctionTok{geom\_vline}\NormalTok{(}\AttributeTok{xintercept =} \FunctionTok{as.Date}\NormalTok{(}\StringTok{"2020{-}04{-}01"}\NormalTok{),}
             \AttributeTok{color =} \StringTok{"blue"}\NormalTok{, }
             \AttributeTok{linetype =} \StringTok{"dashed"}\NormalTok{) }\SpecialCharTok{+} 
  \FunctionTok{annotate}\NormalTok{(}\StringTok{"text"}\NormalTok{, }
           \AttributeTok{x =} \FunctionTok{as.Date}\NormalTok{(}\StringTok{"2020{-}04{-}01"}\NormalTok{) }\SpecialCharTok{+}\DecValTok{80}\NormalTok{, }
           \AttributeTok{y =} \DecValTok{30}\NormalTok{, }\AttributeTok{label =} \StringTok{"Crise du Covid{-}19}\SpecialCharTok{\textbackslash{}n}\StringTok{avril 2020"}\NormalTok{, }
           \AttributeTok{color =} \StringTok{"blue"}\NormalTok{, }
           \AttributeTok{hjust =} \DecValTok{0}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{geom\_vline}\NormalTok{(}\AttributeTok{xintercept =} \FunctionTok{as.Date}\NormalTok{(}\StringTok{"2022{-}06{-}01"}\NormalTok{),}
             \AttributeTok{color =} \StringTok{"brown4"}\NormalTok{, }
             \AttributeTok{linetype =} \StringTok{"dashed"}\NormalTok{) }\SpecialCharTok{+} 
  \FunctionTok{annotate}\NormalTok{(}\StringTok{"text"}\NormalTok{, }
           \AttributeTok{x =} \FunctionTok{as.Date}\NormalTok{(}\StringTok{"2022{-}06{-}01"}\NormalTok{) }\SpecialCharTok{+}\DecValTok{80}\NormalTok{, }
           \AttributeTok{y =} \DecValTok{110}\NormalTok{, }\AttributeTok{label =} \StringTok{"Sortie de la crise Covid}\SpecialCharTok{\textbackslash{}n}\StringTok{guerre en Ukraine}\SpecialCharTok{\textbackslash{}n}\StringTok{juin 2022"}\NormalTok{, }
           \AttributeTok{color =} \StringTok{"brown4"}\NormalTok{, }
           \AttributeTok{hjust =} \DecValTok{0}\NormalTok{)}

\CommentTok{\# affichage du graph}
\FunctionTok{print}\NormalTok{(lissage)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `geom_smooth()` using method = 'loess' and formula = 'y ~ x'
\end{verbatim}

\includegraphics{test_files/figure-latex/cars-7.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-} \#}
\CommentTok{\#                     5.4 Modele linéaire par morceaux                         \#}
\CommentTok{\# {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-} \#}

\CommentTok{\# Définition des points de rupture afin d\textquotesingle{}obtenir un meilleur modèle (R\^{}2)}
\NormalTok{t1 }\OtherTok{\textless{}{-}} \FunctionTok{as.Date}\NormalTok{(}\StringTok{"2020{-}04{-}01"}\NormalTok{)}
\NormalTok{t2 }\OtherTok{\textless{}{-}} \FunctionTok{as.Date}\NormalTok{(}\StringTok{"2022{-}06{-}01"}\NormalTok{)}
\NormalTok{t3 }\OtherTok{\textless{}{-}} \FunctionTok{as.Date}\NormalTok{(}\StringTok{"2023{-}06{-}01"}\NormalTok{)}
\NormalTok{t4 }\OtherTok{\textless{}{-}} \FunctionTok{as.Date}\NormalTok{(}\StringTok{"2024{-}07{-}01"}\NormalTok{)}

\CommentTok{\# Conversion de Month en format Date}
\NormalTok{time }\OtherTok{\textless{}{-}} \FunctionTok{as.Date}\NormalTok{(data\_brent\_2020}\SpecialCharTok{$}\NormalTok{Month)}

\CommentTok{\# Définitoion des périodes à partir des points de ruptures}
\NormalTok{time1 }\OtherTok{\textless{}{-}} \FunctionTok{pmax}\NormalTok{(}\DecValTok{0}\NormalTok{, }\FunctionTok{as.numeric}\NormalTok{(time }\SpecialCharTok{{-}}\NormalTok{ t1)) }
\NormalTok{time2 }\OtherTok{\textless{}{-}} \FunctionTok{pmax}\NormalTok{(}\DecValTok{0}\NormalTok{, }\FunctionTok{as.numeric}\NormalTok{(time }\SpecialCharTok{{-}}\NormalTok{ t2))}
\NormalTok{time3 }\OtherTok{\textless{}{-}} \FunctionTok{pmax}\NormalTok{(}\DecValTok{0}\NormalTok{, }\FunctionTok{as.numeric}\NormalTok{(time }\SpecialCharTok{{-}}\NormalTok{ t3))}
\NormalTok{time4 }\OtherTok{\textless{}{-}} \FunctionTok{pmax}\NormalTok{(}\DecValTok{0}\NormalTok{, }\FunctionTok{as.numeric}\NormalTok{(time }\SpecialCharTok{{-}}\NormalTok{ t4))}

\CommentTok{\# Créer un modèle de régression linéaire par morceaux avec lm et les différentes périodes}
\NormalTok{data\_brent\_2020 }\OtherTok{\textless{}{-}}\NormalTok{ data\_brent\_2020 }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{time =}\NormalTok{ time }\SpecialCharTok{{-}} \FunctionTok{min}\NormalTok{(time))}

\NormalTok{model1}\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(Monthly\_Avg\_Closed\_Cotation }\SpecialCharTok{\textasciitilde{}}\NormalTok{ time }\SpecialCharTok{+}\NormalTok{ time1 }\SpecialCharTok{+}\NormalTok{ time2 }\SpecialCharTok{+}\NormalTok{ time3 }\SpecialCharTok{+}\NormalTok{ time4, }\AttributeTok{data =}\NormalTok{ data\_brent\_2020)}
\FunctionTok{summary}\NormalTok{(model1)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = Monthly_Avg_Closed_Cotation ~ time + time1 + time2 + 
##     time3 + time4, data = data_brent_2020)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -13.3063  -3.7734  -0.5335   3.5273  15.5850 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(>|t|)    
## (Intercept) 63.71776    4.70025  13.556  < 2e-16 ***
## time        -0.38391    0.05888  -6.520 2.88e-08 ***
## time1        0.48133    0.06073   7.926 1.67e-10 ***
## time2       -0.17629    0.01150 -15.324  < 2e-16 ***
## time3        0.10124    0.01684   6.012 1.85e-07 ***
## time4       -0.15942    0.06839  -2.331   0.0237 *  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 5.806 on 52 degrees of freedom
## Multiple R-squared:  0.9267, Adjusted R-squared:  0.9196 
## F-statistic: 131.5 on 5 and 52 DF,  p-value: < 2.2e-16
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{data\_brent\_2020 }\OtherTok{\textless{}{-}}\NormalTok{ data\_brent\_2020 }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{fitted =} \FunctionTok{predict}\NormalTok{(model1))}

\CommentTok{\# nouveau graphique prend celui de base + regression}
\NormalTok{lissage\_reg }\OtherTok{\textless{}{-}}\NormalTok{ lissage1 }\SpecialCharTok{+} 
  \FunctionTok{geom\_line}\NormalTok{(}\AttributeTok{data =}\NormalTok{ data\_brent\_2020, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Month, }\AttributeTok{y =}\NormalTok{ fitted, }\AttributeTok{color =} \StringTok{"Régression linéaire"}\NormalTok{), }\AttributeTok{size =} \FloatTok{0.7}\NormalTok{) }\SpecialCharTok{+}  \CommentTok{\# Ajout de la couleur et du label pour la légende}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Cotation du pétrole Brent"}\NormalTok{) }\SpecialCharTok{+} 
  \FunctionTok{scale\_color\_manual}\NormalTok{(}\AttributeTok{values =} \FunctionTok{c}\NormalTok{(}\StringTok{"Régression linéaire"} \OtherTok{=} \StringTok{"green4"}\NormalTok{, }\StringTok{"Lissage"} \OtherTok{=} \StringTok{"red"}\NormalTok{)) }\SpecialCharTok{+} 
  \FunctionTok{annotate}\NormalTok{(}
    \StringTok{"text"}\NormalTok{, }
    \AttributeTok{x =} \FunctionTok{min}\NormalTok{(data\_brent\_2020}\SpecialCharTok{$}\NormalTok{Month) }\SpecialCharTok{+} \DecValTok{230}\NormalTok{,  }
    \AttributeTok{y =} \FunctionTok{max}\NormalTok{(data\_brent\_2020}\SpecialCharTok{$}\NormalTok{fitted) }\SpecialCharTok{*} \DecValTok{1}\NormalTok{, }
    \AttributeTok{label =} \StringTok{"R² = 92,67 \%"}\NormalTok{, }
    \AttributeTok{vjust =} \DecValTok{1}\NormalTok{,}
    \AttributeTok{fontface =} \StringTok{"bold"}\NormalTok{,}
    \AttributeTok{color =} \StringTok{"green4"}\NormalTok{, }
    \AttributeTok{size =} \DecValTok{4}
\NormalTok{  )}\SpecialCharTok{+}
  \FunctionTok{geom\_segment}\NormalTok{(}
    \FunctionTok{aes}\NormalTok{(}
      \AttributeTok{x =} \FunctionTok{as.Date}\NormalTok{(}\StringTok{"2022{-}04{-}01"}\NormalTok{), }\AttributeTok{y =} \FloatTok{62.5}\NormalTok{,   }
      \AttributeTok{xend =} \FunctionTok{as.Date}\NormalTok{(}\StringTok{"2021{-}11{-}15"}\NormalTok{), }\AttributeTok{yend =} \FloatTok{85.5}  
\NormalTok{    ),}
    \AttributeTok{arrow =} \FunctionTok{arrow}\NormalTok{(}\AttributeTok{length =} \FunctionTok{unit}\NormalTok{(}\FloatTok{0.2}\NormalTok{, }\StringTok{"cm"}\NormalTok{)),  }
    \AttributeTok{color =} \StringTok{"green4"}\NormalTok{,}
    \AttributeTok{size =} \FloatTok{0.5}
\NormalTok{  )}\SpecialCharTok{+}
  \FunctionTok{annotate}\NormalTok{(}
    \StringTok{"text"}\NormalTok{, }
    \AttributeTok{x =} \FunctionTok{as.Date}\NormalTok{(}\StringTok{"2022{-}04{-}01"}\NormalTok{), }
    \AttributeTok{y =} \DecValTok{50}\NormalTok{, }
    \AttributeTok{label =} \StringTok{"β1 = 0.097}\SpecialCharTok{\textbackslash{}n}\StringTok{2.96 $/mois}\SpecialCharTok{\textbackslash{}n}\StringTok{35.56 $/an"}\NormalTok{, }
    \AttributeTok{hjust =} \SpecialCharTok{{-}}\FloatTok{0.2}\NormalTok{,  }
    \AttributeTok{vjust =} \SpecialCharTok{{-}}\FloatTok{0.5}\NormalTok{,  }
    \AttributeTok{fontface =} \StringTok{"bold"}\NormalTok{,}
    \AttributeTok{color =} \StringTok{"green4"}\NormalTok{, }
    \AttributeTok{size =} \FloatTok{3.5}
\NormalTok{  )}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Scale for colour is already present.
## Adding another scale for colour, which will replace the existing scale.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(lissage\_reg)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning in geom_segment(aes(x = as.Date("2022-04-01"), y = 62.5, xend = as.Date("2021-11-15"), : All aesthetics have length 1, but the data has 58 rows.
## i Please consider using `annotate()` or provide this layer with data containing
##   a single row.
\end{verbatim}

\begin{verbatim}
## `geom_smooth()` using method = 'loess' and formula = 'y ~ x'
\end{verbatim}

\begin{verbatim}
## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :
## conversion failure on 'β1 = 0.097' in 'mbcsToSbcs': dot substituted for <ce>
\end{verbatim}

\begin{verbatim}
## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :
## conversion failure on 'β1 = 0.097' in 'mbcsToSbcs': dot substituted for <b2>
\end{verbatim}

\includegraphics{test_files/figure-latex/cars-8.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-} \#}
\CommentTok{\#                5.5 Prevision de la valeur du brent sur 26 mois               \#}
\CommentTok{\# {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-} \#}

\CommentTok{\# Fonction pour la prédiciton pour affficher facilement les 4 modèles }
\NormalTok{pred }\OtherTok{=} \ControlFlowTok{function}\NormalTok{(date,titre\_)\{}
  
\NormalTok{  historique\_pred }\OtherTok{=}\NormalTok{ data\_brent }\SpecialCharTok{\%\textgreater{}\%}
    \FunctionTok{filter}\NormalTok{(Month }\SpecialCharTok{\textgreater{}=} \FunctionTok{as.Date}\NormalTok{(date))}
  
  \CommentTok{\# Conversion de Month en format Date}
\NormalTok{  data\_brent\_pred }\OtherTok{\textless{}{-}}\NormalTok{ historique\_pred }\SpecialCharTok{\%\textgreater{}\%}
    \FunctionTok{mutate}\NormalTok{(}\AttributeTok{time\_pred =} \FunctionTok{as.numeric}\NormalTok{(}\FunctionTok{as.Date}\NormalTok{(Month) }\SpecialCharTok{{-}} \FunctionTok{min}\NormalTok{(}\FunctionTok{as.Date}\NormalTok{(Month)))) }\CommentTok{\# Convertir en jours depuis le début}
  
  \CommentTok{\# Modele}
\NormalTok{  model\_pred }\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(Monthly\_Avg\_Closed\_Cotation }\SpecialCharTok{\textasciitilde{}}\NormalTok{ time\_pred, }\AttributeTok{data =}\NormalTok{ data\_brent\_pred)}
  \FunctionTok{summary}\NormalTok{(model\_pred)}
  
  \CommentTok{\# période à prédire }
\NormalTok{  data\_pred }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{Month =} \FunctionTok{seq}\NormalTok{(}\FunctionTok{as.Date}\NormalTok{(}\StringTok{"2024{-}11{-}01"}\NormalTok{), }\FunctionTok{as.Date}\NormalTok{(}\StringTok{"2026{-}12{-}01"}\NormalTok{), }\AttributeTok{by =} \StringTok{"months"}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
    \FunctionTok{mutate}\NormalTok{(}\AttributeTok{time\_pred =} \FunctionTok{as.numeric}\NormalTok{(}\FunctionTok{as.Date}\NormalTok{(Month) }\SpecialCharTok{{-}} \FunctionTok{min}\NormalTok{(}\FunctionTok{as.Date}\NormalTok{(historique\_pred}\SpecialCharTok{$}\NormalTok{Month)))) }
\NormalTok{  data\_pred }\OtherTok{\textless{}{-}}\NormalTok{ data\_pred }\SpecialCharTok{\%\textgreater{}\%}
    \FunctionTok{mutate}\NormalTok{(}\AttributeTok{fitted =} \FunctionTok{predict}\NormalTok{(model\_pred, }\AttributeTok{newdata =}\NormalTok{ ., }\AttributeTok{interval =} \StringTok{"prediction"}\NormalTok{))}
  
  \CommentTok{\# Extraire les colonnes de la matrice \textquotesingle{}fitted\textquotesingle{} et les ajouter au DataFrame}
\NormalTok{  data\_pred }\OtherTok{\textless{}{-}} \FunctionTok{cbind}\NormalTok{(}
\NormalTok{    data\_pred,}
    \AttributeTok{fit =}\NormalTok{ data\_pred}\SpecialCharTok{$}\NormalTok{fitted[, }\StringTok{"fit"}\NormalTok{],}
    \AttributeTok{lwr =}\NormalTok{ data\_pred}\SpecialCharTok{$}\NormalTok{fitted[, }\StringTok{"lwr"}\NormalTok{],}
    \AttributeTok{upr =}\NormalTok{ data\_pred}\SpecialCharTok{$}\NormalTok{fitted[, }\StringTok{"upr"}\NormalTok{]}
\NormalTok{  )}
  
  \FunctionTok{str}\NormalTok{(data\_pred)}
  \FunctionTok{str}\NormalTok{(historique\_pred)}
  
\NormalTok{  data\_brent\_final }\OtherTok{\textless{}{-}} \FunctionTok{full\_join}\NormalTok{(historique\_pred, data\_pred, }\AttributeTok{by =} \StringTok{"Month"}\NormalTok{)}
  
  \CommentTok{\# graphique}
\NormalTok{  epsi }\OtherTok{\textless{}{-}} \FunctionTok{chronique\_reg}\NormalTok{(}
\NormalTok{    data\_brent\_final,}
    \StringTok{"Cotation du pétrole Brent"}\NormalTok{,}
    \StringTok{"Monthly\_Avg\_Closed\_Cotation"}\NormalTok{,}
    \FloatTok{0.2}\NormalTok{,}
    \StringTok{"Janvier 2010 {-} Octobre 2024"}\NormalTok{,}
    \StringTok{"Cotation (en $)"}\NormalTok{,}
    \StringTok{"Source : investing.com"}\NormalTok{,}
    \FunctionTok{c}\NormalTok{(}\StringTok{"BUT Science des Données {-} Lisieux"}\NormalTok{, }\StringTok{"Diop Mandir {-} Gamondele Maxime {-} Samake Salif"}\NormalTok{)}
\NormalTok{  ) }\SpecialCharTok{+} 
    \FunctionTok{geom\_line}\NormalTok{(}\AttributeTok{data =}\NormalTok{ data\_brent\_final, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Month, }\AttributeTok{y =}\NormalTok{ fit), }\AttributeTok{color =} \StringTok{"blue"}\NormalTok{, }\AttributeTok{size =} \DecValTok{1}\NormalTok{) }\SpecialCharTok{+}  
    \FunctionTok{geom\_ribbon}\NormalTok{(}
      \AttributeTok{data =}\NormalTok{ data\_brent\_final, }
      \FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Month, }\AttributeTok{ymin =}\NormalTok{ lwr, }\AttributeTok{ymax =}\NormalTok{ upr), }
      \AttributeTok{fill =} \StringTok{"blue"}\NormalTok{, }
      \AttributeTok{alpha =} \FloatTok{0.2}
\NormalTok{    ) }\SpecialCharTok{+}  
    \FunctionTok{labs}\NormalTok{(}
      \AttributeTok{title =}\NormalTok{ titre\_,}
      \AttributeTok{x =} \StringTok{"Mois"}\NormalTok{,}
      \AttributeTok{y =} \StringTok{"Cotation (en $)"}
\NormalTok{    ) }\SpecialCharTok{+} 
    \FunctionTok{theme\_minimal}\NormalTok{() }\SpecialCharTok{+} 
    \FunctionTok{theme}\NormalTok{(}
      \AttributeTok{axis.text.x =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{angle =} \DecValTok{45}\NormalTok{, }\AttributeTok{hjust =} \DecValTok{1}\NormalTok{),}
      \AttributeTok{plot.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{hjust =} \FloatTok{0.5}\NormalTok{, }\AttributeTok{face =} \StringTok{"bold"}\NormalTok{, }\AttributeTok{size =} \DecValTok{15}\NormalTok{),}
      \AttributeTok{plot.subtitle =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{hjust =} \FloatTok{0.5}\NormalTok{, }\AttributeTok{colour =} \StringTok{"blue4"}\NormalTok{),}
      \AttributeTok{plot.caption =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{hjust =} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{), }\AttributeTok{face =} \StringTok{"bold"}\NormalTok{, }\AttributeTok{colour =} \StringTok{"blue4"}\NormalTok{),}
      \AttributeTok{legend.position =} \StringTok{"bottom"}\NormalTok{,  }
      \AttributeTok{legend.justification =} \StringTok{"center"}
\NormalTok{    )}
  \FunctionTok{return}\NormalTok{(epsi)}
\NormalTok{\}}


\NormalTok{p1 }\OtherTok{\textless{}{-}} \FunctionTok{pred}\NormalTok{(}\StringTok{"2010{-}01{-}01"}\NormalTok{,}\StringTok{"2010"}\NormalTok{)  }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 'data.frame':    26 obs. of  6 variables:
##  $ Month    : Date, format: "2024-11-01" "2024-12-01" ...
##  $ time_pred: num  5418 5448 5479 5510 5538 ...
##  $ fitted   : num [1:26, 1:3] 64.5 64.3 64.2 64 63.9 ...
##   ..- attr(*, "dimnames")=List of 2
##   .. ..$ : chr [1:26] "1" "2" "3" "4" ...
##   .. ..$ : chr [1:3] "fit" "lwr" "upr"
##  $ fit      : num  64.5 64.3 64.2 64 63.9 ...
##  $ lwr      : num  18.8 18.6 18.5 18.3 18.1 ...
##  $ upr      : num  110 110 110 110 110 ...
## tibble [178 x 6] (S3: tbl_df/tbl/data.frame)
##  $ Month                      : Date[1:178], format: "2010-01-01" "2010-02-01" ...
##  $ Monthly_Avg_Closed_Cotation: num [1:178] 76.3 74.8 79.9 85.8 77 ...
##  $ trend                      : num [1:178] 69.3 72 74.5 77.1 79.6 ...
##  $ saisonnalités              : num [1:178] 7.04 2.76 5.48 8.65 -2.65 ...
##  $ year                       : num [1:178] 2010 2010 2010 2010 2010 2010 2010 2010 2010 2010 ...
##  $ month_day                  : Date[1:178], format: "2010-01-01" "2010-02-01" ...
\end{verbatim}

\begin{verbatim}
## Warning: Vectorized input to `element_text()` is not officially supported.
## i Results may be unexpected or may change in future versions of ggplot2.
\end{verbatim}

\begin{verbatim}
## Warning: Vectorized input to `element_text()` is not officially supported.
## i Results may be unexpected or may change in future versions of ggplot2.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{p2 }\OtherTok{\textless{}{-}} \FunctionTok{pred}\NormalTok{(}\StringTok{"2020{-}01{-}01"}\NormalTok{,}\StringTok{"2020"}\NormalTok{)  }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 'data.frame':    26 obs. of  6 variables:
##  $ Month    : Date, format: "2024-11-01" "2024-12-01" ...
##  $ time_pred: num  1766 1796 1827 1858 1886 ...
##  $ fitted   : num [1:26, 1:3] 97.4 98.1 98.9 99.7 100.4 ...
##   ..- attr(*, "dimnames")=List of 2
##   .. ..$ : chr [1:26] "1" "2" "3" "4" ...
##   .. ..$ : chr [1:3] "fit" "lwr" "upr"
##  $ fit      : num  97.4 98.1 98.9 99.7 100.4 ...
##  $ lwr      : num  63.9 64.6 65.3 66 66.6 ...
##  $ upr      : num  131 132 133 133 134 ...
## tibble [58 x 6] (S3: tbl_df/tbl/data.frame)
##  $ Month                      : Date[1:58], format: "2020-01-01" "2020-02-01" ...
##  $ Monthly_Avg_Closed_Cotation: num [1:58] 63.7 55.5 33.7 26.6 32.4 ...
##  $ trend                      : num [1:58] 50.5 47.9 46.4 45.4 44.4 ...
##  $ saisonnalités              : num [1:58] 13.21 7.56 -12.68 -18.76 -12.03 ...
##  $ year                       : num [1:58] 2020 2020 2020 2020 2020 2020 2020 2020 2020 2020 ...
##  $ month_day                  : Date[1:58], format: "2010-01-01" "2010-02-01" ...
\end{verbatim}

\begin{verbatim}
## Warning: Vectorized input to `element_text()` is not officially supported.
## i Results may be unexpected or may change in future versions of ggplot2.
## Vectorized input to `element_text()` is not officially supported.
## i Results may be unexpected or may change in future versions of ggplot2.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{p3 }\OtherTok{\textless{}{-}} \FunctionTok{pred}\NormalTok{(}\StringTok{"2023{-}01{-}01"}\NormalTok{,}\StringTok{"2023"}\NormalTok{) }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 'data.frame':    26 obs. of  6 variables:
##  $ Month    : Date, format: "2024-11-01" "2024-12-01" ...
##  $ time_pred: num  670 700 731 762 790 821 851 882 912 943 ...
##  $ fitted   : num [1:26, 1:3] 80.7 80.6 80.5 80.4 80.3 ...
##   ..- attr(*, "dimnames")=List of 2
##   .. ..$ : chr [1:26] "1" "2" "3" "4" ...
##   .. ..$ : chr [1:3] "fit" "lwr" "upr"
##  $ fit      : num  80.7 80.6 80.5 80.4 80.3 ...
##  $ lwr      : num  69.6 69.4 69.2 68.9 68.7 ...
##  $ upr      : num  91.8 91.8 91.9 91.9 92 ...
## tibble [22 x 6] (S3: tbl_df/tbl/data.frame)
##  $ Month                      : Date[1:22], format: "2023-01-01" "2023-02-01" ...
##  $ Monthly_Avg_Closed_Cotation: num [1:22] 83.9 83.5 79.1 83.4 75.7 ...
##  $ trend                      : num [1:22] 88.7 87 85.4 83.6 82.2 ...
##  $ saisonnalités              : num [1:22] -4.802 -3.509 -6.241 -0.255 -6.513 ...
##  $ year                       : num [1:22] 2023 2023 2023 2023 2023 ...
##  $ month_day                  : Date[1:22], format: "2010-01-01" "2010-02-01" ...
\end{verbatim}

\begin{verbatim}
## Warning: Vectorized input to `element_text()` is not officially supported.
## i Results may be unexpected or may change in future versions of ggplot2.
## Vectorized input to `element_text()` is not officially supported.
## i Results may be unexpected or may change in future versions of ggplot2.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{p4 }\OtherTok{\textless{}{-}} \FunctionTok{pred}\NormalTok{(}\StringTok{"2024{-}01{-}01"}\NormalTok{,}\StringTok{"2024"}\NormalTok{)  }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 'data.frame':    26 obs. of  6 variables:
##  $ Month    : Date, format: "2024-11-01" "2024-12-01" ...
##  $ time_pred: num  305 335 366 397 425 456 486 517 547 578 ...
##  $ fitted   : num [1:26, 1:3] 77.2 76.4 75.7 74.9 74.2 ...
##   ..- attr(*, "dimnames")=List of 2
##   .. ..$ : chr [1:26] "1" "2" "3" "4" ...
##   .. ..$ : chr [1:3] "fit" "lwr" "upr"
##  $ fit      : num  77.2 76.4 75.7 74.9 74.2 ...
##  $ lwr      : num  65.7 64.4 63 61.6 60.2 ...
##  $ upr      : num  88.7 88.5 88.3 88.3 88.2 ...
## tibble [10 x 6] (S3: tbl_df/tbl/data.frame)
##  $ Month                      : Date[1:10], format: "2024-01-01" "2024-02-01" ...
##  $ Monthly_Avg_Closed_Cotation: num [1:10] 79.1 81.7 84.7 89 83 ...
##  $ trend                      : num [1:10] 80.4 80.4 80.4 80.5 80.5 ...
##  $ saisonnalités              : num [1:10] -1.25 1.33 4.25 8.53 2.48 ...
##  $ year                       : num [1:10] 2024 2024 2024 2024 2024 ...
##  $ month_day                  : Date[1:10], format: "2010-01-01" "2010-02-01" ...
\end{verbatim}

\begin{verbatim}
## Warning: Vectorized input to `element_text()` is not officially supported.
## i Results may be unexpected or may change in future versions of ggplot2.
## Vectorized input to `element_text()` is not officially supported.
## i Results may be unexpected or may change in future versions of ggplot2.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{graph\_prev }\OtherTok{\textless{}{-}}\NormalTok{ p1 }\SpecialCharTok{+}\NormalTok{ p2 }\SpecialCharTok{+}\NormalTok{ p3 }\SpecialCharTok{+}\NormalTok{ p4 }

\NormalTok{graph\_prev}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `geom_smooth()` using method = 'loess' and formula = 'y ~ x'
\end{verbatim}

\begin{verbatim}
## Warning: Removed 26 rows containing non-finite outside the scale range
## (`stat_smooth()`).
\end{verbatim}

\begin{verbatim}
## Warning: Removed 26 rows containing missing values or values outside the scale range
## (`geom_line()`).
\end{verbatim}

\begin{verbatim}
## Warning: Removed 178 rows containing missing values or values outside the scale range
## (`geom_line()`).
\end{verbatim}

\begin{verbatim}
## `geom_smooth()` using method = 'loess' and formula = 'y ~ x'
\end{verbatim}

\begin{verbatim}
## Warning: Removed 26 rows containing non-finite outside the scale range
## (`stat_smooth()`).
\end{verbatim}

\begin{verbatim}
## Warning: Removed 26 rows containing missing values or values outside the scale range
## (`geom_line()`).
\end{verbatim}

\begin{verbatim}
## Warning: Removed 58 rows containing missing values or values outside the scale range
## (`geom_line()`).
\end{verbatim}

\begin{verbatim}
## `geom_smooth()` using method = 'loess' and formula = 'y ~ x'
\end{verbatim}

\begin{verbatim}
## Warning: Removed 26 rows containing non-finite outside the scale range
## (`stat_smooth()`).
\end{verbatim}

\begin{verbatim}
## Warning: Removed 26 rows containing missing values or values outside the scale range
## (`geom_line()`).
\end{verbatim}

\begin{verbatim}
## Warning: Removed 22 rows containing missing values or values outside the scale range
## (`geom_line()`).
\end{verbatim}

\begin{verbatim}
## `geom_smooth()` using method = 'loess' and formula = 'y ~ x'
\end{verbatim}

\begin{verbatim}
## Warning: Removed 26 rows containing non-finite outside the scale range
## (`stat_smooth()`).
\end{verbatim}

\begin{verbatim}
## Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,
## : span too small.  fewer data values than degrees of freedom.
\end{verbatim}

\begin{verbatim}
## Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,
## : pseudoinverse used at 19722
\end{verbatim}

\begin{verbatim}
## Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,
## : neighborhood radius 32.37
\end{verbatim}

\begin{verbatim}
## Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,
## : reciprocal condition number 0
\end{verbatim}

\begin{verbatim}
## Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,
## : There are other near singularities as well. 984.08
\end{verbatim}

\begin{verbatim}
## Warning: Removed 26 rows containing missing values or values outside the scale range
## (`geom_line()`).
\end{verbatim}

\begin{verbatim}
## Warning: Removed 10 rows containing missing values or values outside the scale range
## (`geom_line()`).
\end{verbatim}

\includegraphics{test_files/figure-latex/cars-9.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}
\CommentTok{\#                                    FIN                                       \#}
\DocumentationTok{\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}
\end{Highlighting}
\end{Shaded}

\subsection{Including Plots}\label{including-plots}

You can also embed plots, for example:

\includegraphics{test_files/figure-latex/pressure-1.pdf}

Note that the \texttt{echo\ =\ FALSE} parameter was added to the code
chunk to prevent printing of the R code that generated the plot.

\end{document}
